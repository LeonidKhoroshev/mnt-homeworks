# Домашнее задание к занятию 13 «Введение в мониторинг» - Леонид Хорошев

## Обязательные задания

#### 1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя платформу для вычислений с выдачей текстовых отчётов, которые сохраняются на диск. Взаимодействие с платформой осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы выведите в мониторинг и почему?

Минимальный набор метрик для данного проекта будет выглядеть следующим образом:
- CPU load average - среднее значение загрузки системы (значение в нормальном состоянии находится в диапазоне от 0 до 1, единица соответствует 100% загрузке одноядерной системы без перегруза). Данная метрика позволяет следить за нагрузкой на процессоры и не перегружать систему избыточными отчетами;
- FS - количество свободного места на диске, так как именно туда сохраняются текстовые отчеты, при переполнении дискового пространства данные высока вероятность потери информации из отчетов, которые не были сохранены на жесткий диск;
- IOPS - количество операций ввода/вывода (записи на диск), метрика позволяет отслеживать работоспособность оборудования (резкое повышение показателя IOPS может свидетельствовать о неисправности жестких дисков);
- количество http запросов (метрика может называться по-разному, например http_requests_total)  — метрика позволяет отслеживать величину нагрузки на нашу систему (резкий рост запросов может свидетельствовать о хакерских атаках, либо о других проблемах с доступом по http, в результате которых наша вычислительная платформа может быть неждоступна);
- уровень ошибок при http запросах (метрика может называться по-разному, например http_errors) — количество или частота неуспешно выполненных запросов, например, ответ 500 от HTTP-сервера (логика использования аналогична предыдущему пункту, большое количество ошибок при соединении свидетельствует о сетевых проблемах, а также о возможных сбоях в вычислительных системах).


#### 2. Менеджер продукта, посмотрев на ваши метрики, сказал, что ему непонятно, что такое RAM/inodes/CPUla. Также он сказал, что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы можете ему предложить?

2 из 3 приведенных выше показателей  (CPUla и RAM) показывают состояние нашей системы (нагрузку на оперативную память и процессор соответственно). С помощью них мы можем отслеживать нагрузку на нашу систему. На основе этих данных мы оперативно увеличиваем выделенные ресурсы при пиковых нагрузках или освобождаем их при её уменьшении, тем самым существенно экономим затраты (что особенно ценно при использование облаков и в целом при подходе "инфраструктура как сервис").

inodes (индексный дескриптор -  структура данных, в которой хранятся метаданные файла). Метрика показывает "здоровье" нашей файловой системы, так как нарушение структуры данных жестких дисков ведет к потере информации, в том числе критически важной.

Для менеджера данные показатели сами по себе могут ни о чем не говорить, но от них напрямую зависит качество обслуживания клиентов, поэтому на управленческом уровне целесообразно оперировать такими понятиями, как:
- SLI (service level indicator) - индикатор качества обслуживания. Конкретная величина предоставляемого обслуживания (например количество времени в год, когда наш сервис доступен, время отклика в секундах, процент успешных http запросов и т.д.). Чаще всего показатели представляются в процентном эквиваленте, где 100 % - отлично, а 0% - неприемлимо;
- SLO (service level objectives) — целевой уровень качества обслуживания (целевое значение наших SLI ).

На основании данных о целевых и реальных SLI менеджментом может быть принято решение о введении SLA (service level agreement) - соглашение об уровне обслуживания. Явный (штрафные санкции, зафиксированные юридически) или неявный (скидки, промокоды и т.д. в случае недовольства клиентов)контракт с внешними пользователями, включающий в себя последствия невыполнения SLO. 

3. Вашей DevOps-команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики, в свою очередь, хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, чтобы разработчики получали ошибки приложения?

3. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA = 99% по http-кодам ответов. 
Этот параметр вычисляется по формуле: summ_2xx_requests/summ_all_requests. Он не поднимается выше 70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

## Дополнительное задание* (со звёздочкой) 

Выполнение этого задания необязательно и никак не влияет на получение зачёта по домашней работе.

_____

Вы устроились на работу в стартап. На данный момент у вас нет возможности развернуть полноценную систему 
мониторинга, и вы решили самостоятельно написать простой python3-скрипт для сбора основных метрик сервера. 

Вы, как опытный системный администратор, знаете, что системная информация сервера лежит в директории `/proc`. Также знаете, что в системе Linux есть  планировщик задач cron, который может запускать задачи по расписанию.

Суммировав всё, вы спроектировали приложение, которое:

- является python3-скриптом;
- собирает метрики из папки `/proc`;
- складывает метрики в файл 'YY-MM-DD-awesome-monitoring.log' в директорию /var/log 
(YY — год, MM — месяц, DD — день);
- каждый сбор метрик складывается в виде json-строки, в виде:
  + timestamp — временная метка, int, unixtimestamp;
  + metric_1 — метрика 1;
  + metric_2 — метрика 2;
  
     ...
     
  + metric_N — метрика N.
  
- сбор метрик происходит каждую минуту по cron-расписанию.

Для успешного выполнения задания нужно привести:

* работающий код python3-скрипта;
* конфигурацию cron-расписания;
* пример верно сформированного 'YY-MM-DD-awesome-monitoring.log', имеющий не меньше пяти записей.

Дополнительная информация:

1. Количество собираемых метрик должно быть не меньше четырёх.
1. По желанию можно не ограничивать себя только сбором метрик из `/proc`.

---

### Как оформить решение задания

Выполненное домашнее задание пришлите в виде ссылки на .md-файл в вашем репозитории.


---
